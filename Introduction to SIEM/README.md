# Introduction

A Security Information and Event Management (SIEM) system is an essential tool that gathers data from diverse endpoints and network devices throughout a network, centralizes the information, and conducts correlation analysis. This room aims to provide an overview of the fundamental concepts necessary for comprehending SIEM functionality and operations.

> What does SIEM stand for?
> 
> ```plaintext
> Security Information and Event Management system
> ```

---

# Network Visibility through SIEM

![](/res/ef9bb34bf47574a0fdbebad347f4a42e.png)

Getting all the information and Logs from the devices that are attached to the network is very hard to get because of the comples network architecture. In that, we have 2 types of information a SIEM can get from a network.

1. **Host-Centric Log Resource:**
    
    Host-centric logs are generated by various log sources that capture events occurring within or related to a specific host. These logs provide valuable insights into the activities and behaviors of individual systems. Several log sources commonly used for collecting host-centric logs include Windows Event logs, Sysmon, Osquery, and similar tools.
    
    \[+\] A user accessing a file
    
    \[+\] A user attempting to authenticate.
    
    \[+\] A process Execution Activity
    
    \[+\] A process adding/editing/deleting a registry key or value.
    
    \[+\] Powershell execution
    
2. Network-Centric Log Resources:
    
    Network-related logs are created when hosts engage in communication with each other or access the internet, such as browsing websites or utilizing various network-based protocols. These logs offer valuable insights into network traffic, connections, and interactions. Several network-based protocols commonly encountered in log data include SSH, VPN, HTTP/s, FTP, and more.
    
    \[+\] SSH connection
    
    \[+\] A file being accessed via FTP
    
    \[+\] Web traffic
    
    \[+\] A user accessing company's resources through VPN.
    
    \[+\] Network file sharing Activity
    

> Is Registry-related activity host-centric or network-centric?
> 
> ```plaintext
> host-centric
> ```
> 
> Is VPN related activity host-centric or network-centric?
> 
> ```plaintext
> network-centric
> ```

---

# Log Sources and Log Ingestion

Various devices store logs in different locations. Windows, Linux, Mac and other IoT devices that are connected to the production environment SIEM collects logs from every device. SIEM find the log from the location and process that logs to normalize results.

1. **Windows Machine Log:**
    
    It mainly stores in the `Event Viewer`.
    
    ![Shows Events in Event Viewer Interface](https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/30beed26fc514cb7f52773b88a4510b9.gif align="left")
    
2. **Linux Machine:**
    
    Linux stores log in various locations inside `/var/log`.
    
    \[+\] **/var/log/httpd**: Contains HTTP Request.
    
    \[+\] **/var/log/apache**: webserver-related logs for apache server.
    
    \[+\] **/var/log/cron**: Events related to cron jobs.
    
    \[+\] **/var/log/auth.log** and **/var/log/secure**: Stores authentication-related logs.
    
    \[+\] **/var/log/kern**: This file stores kernel-related events.
    

### Log Ingestion

This is mainly collecting logs from all the devices from the nework and feed it to the SIEM. In order to do that SIEM uses various methods.

1. Agent/Forward: SIEM install a lightweight agent to all the devices to forward the logs to the SIEM.
    
2. Syslog: widely used protocol to collect logs from webserver, databases etc.
    
3. Manual Upload: many SIEM use ELK, Splunk to upload logs from offline devices to quickly analyze.
    
4. Port-Forwarding: a particular port is used to forward logs to the SIEM.
    

> In which location within a Linux environment are HTTP logs are stored?
> 
> ```plaintext
> /var/log/httpd
> ```

### Why SIEM

A SIEM is mainly used in Security Operation Center or SOC for the following reasons

\[+\] Threat Detection and Incident Response

\[+\] Centralized Log Management

\[+\] Real-time Monitoring and Alerts

\[+\] Compliance and Regulatory Requirements

\[+\] Threat Intelligence Integration

\[+\] Forensic Investigation and Analysis

> Read the task above.
> 
> ```plaintext
> Identifying blind spots in the network visibility and covering them.
> Answer the questions below
> Read the task above.
> No answer needed
> ```

### Analysing Logs and Alerts

There is a Dashboard in every SIEM that shows the normalized status of every analyze containing every important information. It inlcludes

\[+\] Alert Highlights

\[+\]System Notification

\[+\] Health Alert

\[+\] List of Failed Login Attempts

\[+\] Events Ingested Count

\[+\] Rules triggered

\[+\] Top Domains Visited

Default Dashboard of Qradar SIEM.

![Default Dashboard of Qradar SIEM](https://tryhackme-images.s3.amazonaws.com/user-uploads/5e8dd9a4a45e18443162feab/room-content/24f94de3e052afd4702440c06e81e622.png align="left")

> Which Event ID is generated when event logs are removed?
> 
> ```plaintext
> 104
> ```
> 
> What type of alert may require tuning?
> 
> ```plaintext
> False Alarm
> ```

### Lab Work

Click on the `View Site` button and then click `Start Activity` from the side window. It will detect `cudominer.exe` as a suspicious activity. Click that process it will redirect to the next window.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1686936354152/03266013-0e47-4aa5-b34e-ef93ea2520e7.png align="center")

> Click on Start Suspicious Activity, which process caused the alert?
> 
> ```plaintext
> cudominer.exe 
> ```

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1686938707716/93eb73a6-c427-4192-8e1b-13a3c90b5365.png align="center")

> Find the event that caused the alert, which user was responsible for the process execution?
> 
> ```plaintext
> chris.fort
> ```

> What is the hostname of the suspect user?
> 
> ```plaintext
> HR_02
> ```

> Examine the rule and the suspicious process; which term matched the rule that caused the alert?
> 
> ```plaintext
> miner
> ```

Find the event and click on it to view the rule. And select True-positive as action since its detected a crypto miner right.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1686938392678/5442772b-c3ac-4ed1-9222-585a2e557deb.png align="center")

> What is the best option that represents the event? Choose from the following:
> 
> ```plaintext
> True-Positive
> ```

and you get the flag.

---

### Conclusion

In this discussion, we have delved into the concept of SIEM (Security Information and Event Management), exploring its fundamental nature, the range of its capabilities, and the valuable insights it offers through enhanced visibility.
